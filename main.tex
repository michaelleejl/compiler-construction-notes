\documentclass[12pt,a4paper,twoside,openany, chapterprefix=on]{scrbook} 
\usepackage{euan}

\newcommand{\redbf}[1]{\textcolor{darkred}{\textbf{#1}}}

\let\oldtabularx\tabularx
\renewcommand*{\tabularx}{\rowcolors{1}{}{white}\oldtabularx}
\colorlet{selected}{selected}
\tcbuselibrary{skins}

\newtcolorbox{tcbleftbar}[1][]{
blanker, left=1em, colback=white, before=\par\noindent, borderline west = {0.5pt}{0pt}{grey}, #1
}
\tcbset{on line, 
        boxsep=4pt, left=0pt,right=0pt,top=0pt,bottom=0pt,
        colframe=white,colback=nonterminal!100,  
        highlight math style={enhanced}
        }
        
\usetikzlibrary{intersections}
\usetikzlibrary{bending,shapes,backgrounds,patterns,shapes.misc}
\usetikzlibrary{positioning,arrows,automata,arrows.meta,calc}
\tikzset{rectangular state/.style={draw,rectangle,rounded corners}}
\renewcommand\theadfont{\bfseries}
\tcbuselibrary{hooks}

\newtcolorbox{tctabularx}[1]{%
        enhanced,
        fonttitle=\sffamily\bfseries,
        fontupper=\sffamily,
        colback=verylightgrey,
        colframe=grey!50!black,colbacktitle=gray,
        coltitle=black,
        boxrule=0pt,
        sharp corners,
        #1,
        boxrule=0.5pt,
        before upper app={\rowcolor{lightgrey}\theadfont{\bfseries}}
}% end tctabularx        

\setkomafont{dictumtext}{\itshape \small}
\setkomafont{dictumauthor}{\normalfont}
\renewcommand*\dictumwidth{.6\linewidth}
\renewcommand*\dictumauthorformat[1]{--- #1}
\renewcommand*\dictumrule{}

\raggedbottom

\pagestyle{plain}

\makeatletter
\Hy@AtBeginDocument{%
  \def\@pdfborder{0 0 1}% Overrides border definition set with colorlinks=true
  \def\@pdfborderstyle{/S/U/W 1}% Overrides border style set with colorlinks=true
                                % Hyperlink border style will be underline of width 1pt
}
\makeatother
\hypersetup{
    colorlinks = true,
    linkcolor = linkcolor,
    linkbordercolor = linkcolor,
    citecolor = black,
    pdfborderstyle={/S/U/W 1},
    urlcolor = linkcolor,
    urlbordercolor = linkcolor,
    citebordercolor = white!0
}

\newcommand\blfootnote[1]{%
  \begin{NoHyper}%
  \renewcommand\thefootnote{}\footnote{#1}%
  \addtocounter{footnote}{-1}%
  \end{NoHyper}%
}


% \SetupFloatingEnvironment{listing}{name=Source Code}

\setlength{\epigraphwidth}{0.6\textwidth}
\setlength{\epigraphrule}{0pt}
\makeatletter
\newlength\epitextskip
\pretocmd{\@epitext}{\em}{}{}
\apptocmd{\@epitext}{\em}{}{}
\patchcmd{\epigraph}{\@epitext{#1}\\}{\@epitext{#1}\\[\epitextskip]}{}{}
\makeatother

\lstdefinelanguage{OCaml}{
  keywords={
    and,as,assert,asr,begin,class,constraint,do,done,downto,effect,else,end,exception,
    external,false,for,fun,function,functor,if,implicit,in,include,inherit,initializer,
    land,lazy,let,lor,lsl,lsr,lxor,macro,match,method,mod,module,mutable,new,object,
    of,open,or,private,rec,sig,struct,then,to,true,try,type,val,virtual,when,
    with,while},
  comment=[s]{(*}{*)},
}

\lstdefinestyle{c}{
  basicstyle=\linespread{0.88}\scriptsize\ttfamily,
  commentstyle=\color{darkpurple},
  keywordstyle=\color{darkred}\sffamily,
  showstringspaces=false,
  mathescape=true,
  escapeinside=!!
}

\lstdefinestyle{ocaml}{
  language=OCaml,
  basicstyle=\linespread{0.88}\scriptsize\ttfamily,
  commentstyle=\color{darkpurple},
  keywordstyle=\color{darkred}\sffamily,
  showstringspaces=false,
  mathescape=true,
  escapeinside=!!
}

\lstdefinelanguage{Slang}{
  keywords={
    if,fi,then,else,ref,true,false,let,case,rec,in,begin,end,inl,inr,fst,snd,fun,nuf,case,of,while,do,od},
  comment=[s]{(*}{*)},
}
\lstdefinestyle{Slang}{
  basicstyle=\ttfamily\small,
  basewidth=0.5em,
  commentstyle=\color{darkgreen},
  escapeinside={(**}{)},
  keywordstyle=\bfseries,
  language=Slang,
  stringstyle=\color{darkblue},
  showstringspaces=false,
  mathescape=true,
}

\lstdefinestyle{ocaml-reg}{
  language=OCaml,
  basicstyle=\linespread{1.5}\normalsize\ttfamily,
  commentstyle=\color{darkpurple},
  keywordstyle=\bfseries\color{darkred},
  showstringspaces=false,
  mathescape=true,
  escapeinside=!!
}

\lstdefinestyle{pseudocode}{
  basicstyle=\ttfamily,
  escapeinside=!!,
  backgroundcolor=\color{backcolour}
}

\newcommand{\optional}{\texorpdfstring{$^*$ \textcolor{highlight}{(Optional)}}{(Optional)}}

\makeatletter
\newcommand\incircbin
{%
  \mathpalette\@incircbin
}
\newcommand\@incircbin[2]
{%
  \mathbin%
  {%
    \ooalign{\hidewidth$#1#2$\hidewidth\crcr$#1\bigcirc$}%
  }%
}
\newcommand{\ostar}{\incircbin{*}}

% \SetupFloatingEnvironment{listing}{name=Source Code}

\newcounter{codeCounter}[section]
\counterwithin{codeCounter}{section}
\newenvironment{code}[1][]{\centering%
\refstepcounter{codeCounter}%
\def\captiontemp{#1}%
}{\begin{center}%
\vspace{-5mm}
{Listing~\thecodeCounter. \captiontemp}%
\end{center}}

\crefname{codeCounter}{listing}{listings}
\Crefname{codeCounter}{Listing}{Listings}

% \bibliographystyle{abbrvnat}

\setkomafont{chapterprefix}{\Large}
% \setlength{\footnotemargin}{2mm}

\usetikzlibrary{arrows}
\usetikzlibrary{positioning}
\usetikzlibrary{calc}

\tikzset{edge/.style = {->,> = latex'}}
\tikzset{equality/.style = {double, double distance=2.5pt}}
\tikzset{vertex/.style={text depth=0.4ex}}
\usetikzlibrary{positioning}

\title{Compilers Notes}
\author{mjll2}
\date{June 2024}

\begin{document}

\maketitle

\frontmatter
{
\hypersetup{linkcolor=black, linkbordercolor=white}
\tableofcontents
}

\mainmatter

\import{lec01}{introduction}

\part{The Front-End}
\import{lec02}{lexing}
\import{lec03}{context-free-grammars}
\import{lec03}{parser-combinators}
\import{lec04}{LL(k)}
\import{lec05}{LR}
\import{lec07}{typechecking}

\part{The Middle-End}
\import{lec07}{interpreter0}
\import{lec08}{cps}

\part{Advanced Topics}
\import{lec12}{garbage-collection}
\import{lec13}{exceptions}
\import{lec14}{optimisation}
\import{lec15}{linking}
\import{lec16}{bootstrapping}

\bibliography{library}

\end{document}